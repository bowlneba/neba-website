@inherits LayoutComponentBase
@inject NavigationManager Nav

<!-- Skip to main content for accessibility -->
<a href="#main-content" class="skip-link">
    Skip to main content
</a>

<div class="layout-container">
    <!-- Top Banner -->
    <div class="neba-top-banner">
        <div class="neba-banner-content">
            <div class="banner-logo-container">
                <a href="/" aria-label="Go to home page">
                    <img src="images/neba-logo.png" alt="NEBA Logo" class="banner-logo" />
                </a>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <NavMenu />

    <!-- Main Content -->
    <main class="main-content" role="main" id="main-content">
        <article class="content-wrapper">
            @Body
        </article>
    </main>

    <!-- Footer -->
    <footer class="neba-footer" role="contentinfo" aria-label="Site footer">
        <div class="footer-content">
            <div class="footer-row">
                <div class="footer-copyright">
                    <p>&copy; @DateTime.Now.Year New England Bowling Association. All rights reserved.</p>
                </div>
                <nav class="footer-links" aria-label="Footer navigation">
                    <a href="/privacy">Privacy Policy</a>
                    <a href="/terms">Terms of Service</a>
                    <a href="/contact">Contact</a>
                </nav>
            </div>
        </div>
    </footer>
</div>

<div id="blazor-error-ui" data-nosnippet role="alert" aria-live="assertive">
    <div class="error-content">
        <span>An unhandled error has occurred.</span>
        <div class="error-actions">
            <a href="." class="neba-btn neba-btn-sm neba-btn-primary">Reload</a>
            <button class="dismiss neba-btn neba-btn-sm neba-btn-secondary" aria-label="Dismiss error">Ã—</button>
        </div>
    </div>
</div>

@code {
    /// <summary>
    /// Checks if the given path matches the current route.
    /// Used for highlighting active navigation items.
    /// </summary>
    /// <param name="path">The path to check (without leading slash)</param>
    /// <returns>True if the path matches the current route</returns>
    protected bool IsActive(string path)
    {
        var current = Nav.ToBaseRelativePath(Nav.Uri);

        if (string.IsNullOrEmpty(current))
        {
            current = "/";
        }

        path = path.TrimStart('/');

        if (string.IsNullOrEmpty(path))
        {
            path = "/";
        }

        // Exact match
        if (current == path)
            return true;

        // Section match (e.g., /tournaments/123 matches /tournaments)
        if (current.StartsWith(path + "/", StringComparison.OrdinalIgnoreCase))
            return true;

        return false;
    }
}
